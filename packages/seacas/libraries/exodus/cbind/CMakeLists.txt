INCLUDE(TribitsLibraryMacros)
INCLUDE(TribitsAddExecutableAndTest)

CONFIGURE_FILE(
  ${CMAKE_CURRENT_SOURCE_DIR}/include/exodusII_cfg.h.in
  ${CMAKE_CURRENT_BINARY_DIR}/include/exodusII_cfg.h
  @ONLY IMMEDIATE)


INCLUDE_DIRECTORIES(
  "${CMAKE_CURRENT_SOURCE_DIR}/include"
  "${CMAKE_CURRENT_BINARY_DIR}/include"
  "${NETCDF_INCLUDE_DIR}"
)

FILE(GLOB SOURCES src/*.c)

SET(HEADERS
  include/exodusII.h
  include/exodusII_par.h
)

if(${CMAKE_PROJECT_NAME} STREQUAL "SEACAS")
  SET(ENABLED Exodus)
else()
  SET(ENABLED SEACASExodus)
endif()
ASSERT_DEFINED(${ENABLED}_ENABLE_MPI)
IF (NOT ${ENABLED}_ENABLE_MPI)
  LIST(REMOVE_ITEM SOURCES "${CMAKE_CURRENT_SOURCE_DIR}/src/ex_create_par.c")
  LIST(REMOVE_ITEM SOURCES "${CMAKE_CURRENT_SOURCE_DIR}/src/ex_open_par.c")
  LIST(REMOVE_ITEM HEADERS "${CMAKE_CURRENT_SOURCE_DIR}/include/exodusII_par.h")
ENDIF()

if(${CMAKE_PROJECT_NAME} STREQUAL "SEACAS")
  ASSERT_DEFINED(TPL_Netcdf_Enables_Netcdf4)
  if(NOT TPL_Netcdf_Enables_Netcdf4) 
         ADD_DEFINITIONS(-DNOT_NETCDF4)
  endif()
endif()

TRIBITS_ADD_LIBRARY(
	exodus
	HEADERS	${HEADERS}
	SOURCES ${SOURCES}
)

TRIBITS_INSTALL_HEADERS(HEADERS ${HEADERS})

TRIBITS_ADD_TEST_DIRECTORIES(test)
