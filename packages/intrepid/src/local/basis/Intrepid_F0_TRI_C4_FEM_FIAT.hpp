#ifndef INTREPID_F0_TRI_C4_FEM_FIAT_HPP
#define INTREPID_F0_TRI_C4_FEM_FIAT_HPP
#include "Intrepid_Basis.hpp"
#include "Intrepid_RealSpace.hpp"
#include "Intrepid_Utils.hpp"
#include "Intrepid_Tabulate.hpp"
#include "Intrepid_FieldContainer.hpp"
#include "Teuchos_Array.hpp"
#include "Teuchos_BLAS_types.hpp"

namespace Intrepid {

/** \class Intrepid::Basis_F0_TRI_C4_FEM_FIAT
  \brief Implementation of FIAT FEM basis functions of degree 4 for 0-forms on TRI cells. 
  Reconstruction space type is COMPLETE. Definition of the DoF set 
  for this basis, its enumeration and the associated local DoF tags are as follows,

\verbatim
  =================================================================================================
  |        |                degree-of-freedom-tag              |                                  |
  | DoF Id |---------------------------------------------------|          DoF definition          |
  |        |  subc dim  |  subc id   | subc DoFId |subc num DoF|                                  |
  |========|============|============|============|============|==================================|
  |    0   |     0      |     0      |     0      |     1      |               L_0(u)=u(0.0,0.0)  |
  |========|============|============|============|============|==================================|
  |    1   |     0      |     1      |     0      |     1      |               L_1(u)=u(1.0,0.0)  |
  |========|============|============|============|============|==================================|
  |    2   |     0      |     2      |     0      |     1      |               L_2(u)=u(0.0,1.0)  |
  |========|============|============|============|============|==================================|
  |    3   |     1      |     0      |     0      |     3      |              L_3(u)=u(0.25,0.0)  |
  |========|============|============|============|============|==================================|
  |    4   |     1      |     0      |     1      |     3      |               L_4(u)=u(0.5,0.0)  |
  |========|============|============|============|============|==================================|
  |    5   |     1      |     0      |     2      |     3      |              L_5(u)=u(0.75,0.0)  |
  |========|============|============|============|============|==================================|
  |    6   |     1      |     1      |     0      |     3      |             L_6(u)=u(0.75,0.25)  |
  |========|============|============|============|============|==================================|
  |    7   |     1      |     1      |     1      |     3      |               L_7(u)=u(0.5,0.5)  |
  |========|============|============|============|============|==================================|
  |    8   |     1      |     1      |     2      |     3      |             L_8(u)=u(0.25,0.75)  |
  |========|============|============|============|============|==================================|
  |    9   |     1      |     2      |     0      |     3      |              L_9(u)=u(0.0,0.75)  |
  |========|============|============|============|============|==================================|
  |   10   |     1      |     2      |     1      |     3      |              L_10(u)=u(0.0,0.5)  |
  |========|============|============|============|============|==================================|
  |   11   |     1      |     2      |     2      |     3      |             L_11(u)=u(0.0,0.25)  |
  |========|============|============|============|============|==================================|
  |   12   |     2      |     0      |     0      |     3      |            L_12(u)=u(0.25,0.25)  |
  |========|============|============|============|============|==================================|
  |   13   |     2      |     0      |     1      |     3      |             L_13(u)=u(0.5,0.25)  |
  |========|============|============|============|============|==================================|
  |   14   |     2      |     0      |     2      |     3      |             L_14(u)=u(0.25,0.5)  |
  |========|============|============|============|============|==================================|


\endverbatim

  The DefaultBasisFactory will select this basis
  if the following parameters are specified:
  \verbatim
  |=======================|===================================|
  |  EField               |  FIELD_FORM_0                     |
  |-----------------------|-----------------------------------|
  |  ECell                |  CELL_TRI                   |
  |-----------------------|-----------------------------------|
  |  EReconstructionSpace |  RECONSTRUCTION_SPACE_COMPLETE    |
  |-----------------------|-----------------------------------|
  |  degree               |  4                          |
  |-----------------------|-----------------------------------|
  |  EBasis               |  BASIS_FEM_FIAT                   |
  |-----------------------|-----------------------------------|
  |  ECoordinates         |  COORDINATES_CARTESIAN            |
  |=======================|===================================|
  \endverbatim

*/

template<class Scalar>
class Basis_F0_TRI_C4_FEM_FIAT: public Basis<Scalar> {
  private:
  
  /** \brief Dimension of the space spanned by the basis = number of degrees of freedom.
  */
  int numDof_;
  
  /**\brief Lookup table for the DoF's local enumeration (DoF Id) by its local DoF tag
  */
  Teuchos::Array<Teuchos::Array<Teuchos::Array<int> > > tagToEnum_;
  
  /**\brief Lookup table for the DoF's local DoF tag by its local enumeration (DoF Id)
  */
  Teuchos::Array<LocalDofTag> enumToTag_;
  
  /**\brief "true" if both lookup arrays have been set by initialize()
  */
  bool isSet_;

  /**\brief coefficients of nodal basis in terms of orthogonal polynomials */
  Teuchos::RCP<Teuchos::SerialDenseMatrix<int,Scalar> > vdm_;
  Teuchos::RCP<Teuchos::SerialDenseMatrix<int,Scalar> > dmats0_;
  Teuchos::RCP<Teuchos::SerialDenseMatrix<int,Scalar> > dmats1_;

/* \brief Static data array that provides the Vandermonde and derivative matrices.  They need to
     be static data members because of the templating w.r.t type */
    static Scalar *get_vdm_data() {
    static Scalar vdm_data[] = { -1.3877787807814457e-17 , -2.7755575615628914e-17 , 1.5816272453985370e-17 , 8.8888888888888934e-02 , -2.2222222222222230e-02 , 8.8888888888888920e-02 , 8.8888888888888934e-02 , -2.2222222222222254e-02 , 8.8888888888888920e-02 , 8.8888888888888920e-02 , -2.2222222222222310e-02 , 8.8888888888889045e-02 , 1.7777777777777770e-01 , 1.7777777777777781e-01 , 1.7777777777777784e-01 , -7.1428571428571508e-02 , 7.1428571428571411e-02 , -5.3572666585086913e-17 , -1.5238095238095231e-01 , 5.9799314236423781e-17 , 1.5238095238095234e-01 , 2.2857142857142859e-01 , 1.9047619047618980e-02 , 7.6190476190476156e-02 , -7.6190476190476239e-02 , -1.9047619047618869e-02 , -2.2857142857142862e-01 , -6.0952380952380936e-01 , 6.0952380952380958e-01 , -2.1429066634034765e-16 , -2.3809523809523812e-02 , -2.3809523809523819e-02 , 4.7619047619047616e-02 , -1.0158730158730160e-01 , -1.2698412698412690e-02 , -1.0158730158730160e-01 , -2.5396825396825379e-02 , 6.3492063492063266e-03 , 1.2698412698412698e-01 , 1.2698412698412695e-01 , 6.3492063492063266e-03 , -2.5396825396825379e-02 , -2.0317460317460320e-01 , -2.0317460317460320e-01 , 4.0634920634920646e-01 , 7.9365079365079291e-02 , 7.9365079365079361e-02 , 0.0000000000000000e+00 , 2.5396825396825395e-01 , -6.6666666666666663e-01 , 2.5396825396825395e-01 , 3.8095238095238099e-01 , -1.1102230246251565e-16 , 0.0000000000000000e+00 , -1.6917684184764292e-16 , -1.1102230246251565e-16 , 3.8095238095238099e-01 , -3.8095238095238099e-01 , -3.8095238095238099e-01 , 2.2204460492503131e-16 , 4.7619047619047651e-02 , -4.7619047619047630e-02 , 0.0000000000000000e+00 , 2.2857142857142856e-01 , 6.6613381477509390e-17 , -2.2857142857142859e-01 , -1.5238095238095234e-01 , 4.0000000000000002e-01 , 7.6190476190476142e-02 , -7.6190476190476225e-02 , -4.0000000000000002e-01 , 1.5238095238095242e-01 , -2.2857142857142859e-01 , 2.2857142857142856e-01 , 0.0000000000000000e+00 , 1.5873015873015865e-02 , 1.5873015873015865e-02 , 4.7619047619047616e-02 , 8.8888888888888906e-02 , 6.6666666666666666e-02 , 8.8888888888888906e-02 , 3.8095238095238106e-02 , -2.0000000000000001e-01 , 1.9047619047619047e-01 , 1.9047619047619044e-01 , -2.0000000000000001e-01 , 3.8095238095238106e-02 , -7.6190476190476225e-02 , -7.6190476190476225e-02 , -2.2857142857142851e-01 , -1.4814814814814806e-01 , 1.4814814814814817e-01 , -2.6316397620744449e-17 , 2.9629629629629617e-01 , -1.1842378929335003e-16 , -2.9629629629629622e-01 , 2.3703703703703702e-01 , 0.0000000000000000e+00 , 4.3860662701240750e-17 , -4.3860662701240750e-17 , 8.7721325402481500e-17 , -2.3703703703703707e-01 , 7.1111111111111114e-01 , -7.1111111111111103e-01 , -1.7544265080496300e-16 , -1.0582010582010583e-01 , -1.0582010582010583e-01 , 0.0000000000000000e+00 , -4.2328042328042340e-02 , 2.9629629629629628e-01 , -4.2328042328042340e-02 , 8.4656084656084624e-02 , 2.9629629629629628e-01 , 0.0000000000000000e+00 , -3.7594853743920630e-17 , 2.9629629629629628e-01 , 8.4656084656084624e-02 , -8.4656084656084624e-02 , -8.4656084656084624e-02 , -5.9259259259259256e-01 , -6.3492063492063502e-02 , 6.3492063492063489e-02 , 2.8196140307940482e-17 , -1.2698412698412698e-01 , 0.0000000000000000e+00 , 1.2698412698412700e-01 , -1.5238095238095239e-01 , 5.6392280615880964e-17 , 2.5396825396825395e-01 , -2.5396825396825395e-01 , -8.4588420923821446e-17 , 1.5238095238095242e-01 , 3.0476190476190479e-01 , -3.0476190476190479e-01 , 1.1278456123176193e-16 , -2.1164021164021149e-02 , -2.1164021164021156e-02 , 8.4656084656084665e-02 , -5.9259259259259268e-02 , -5.9259259259259268e-02 , -5.9259259259259268e-02 , 6.7724867724867702e-02 , -5.9259259259259234e-02 , -1.6931216931216939e-02 , -1.6931216931216905e-02 , -5.9259259259259234e-02 , 6.7724867724867702e-02 , 2.2010582010582014e-01 , 2.2010582010582014e-01 , -2.8783068783068788e-01 , 1.5238095238095242e-01 , 1.5238095238095242e-01 , 0.0000000000000000e+00 , -6.0952380952380958e-01 , 9.1428571428571426e-01 , -6.0952380952380958e-01 , -8.0202354653697369e-17 , 8.0202354653697369e-17 , 0.0000000000000000e+00 , 3.5617000306274957e-32 , 8.0202354653697369e-17 , -8.0202354653697369e-17 , 8.0202354653697369e-17 , 8.0202354653697369e-17 , -1.6040470930739474e-16 , 1.1851851851851854e-01 , -1.1851851851851851e-01 , -2.6316397620744449e-17 , -2.3703703703703707e-01 , -1.3158198810372225e-16 , 2.3703703703703707e-01 , 2.3703703703703702e-01 , 0.0000000000000000e+00 , 4.3860662701240750e-17 , -4.3860662701240750e-17 , 8.7721325402481500e-17 , -2.3703703703703707e-01 , 7.1111111111111125e-01 , -7.1111111111111103e-01 , -1.7544265080496300e-16 , 8.4656084656084679e-02 , 8.4656084656084651e-02 , 0.0000000000000000e+00 , -4.2328042328042326e-02 , -8.4656084656084651e-02 , -4.2328042328042326e-02 , -2.9629629629629628e-01 , 2.9629629629629628e-01 , 0.0000000000000000e+00 , 1.3158198810372225e-16 , 2.9629629629629628e-01 , -2.9629629629629628e-01 , 2.9629629629629628e-01 , 2.9629629629629628e-01 , -5.9259259259259256e-01 , 5.0793650793650801e-02 , -5.0793650793650801e-02 , -2.5376526277146434e-17 , 2.5396825396825397e-02 , 6.3441315692866086e-18 , -2.5396825396825400e-02 , 2.2857142857142856e-01 , -3.8095238095238099e-01 , 2.5396825396825395e-01 , -2.5396825396825395e-01 , 3.8095238095238104e-01 , -2.2857142857142856e-01 , -7.6190476190476128e-02 , 7.6190476190476225e-02 , -1.0150610510858574e-16 , 1.6931216931216929e-02 , 1.6931216931216932e-02 , 8.4656084656084651e-02 , 1.6931216931216932e-02 , 1.6931216931216929e-02 , 1.6931216931216932e-02 , -8.4656084656084651e-02 , 1.6931216931216930e-01 , -1.6931216931216930e-01 , -1.6931216931216930e-01 , 1.6931216931216930e-01 , -8.4656084656084651e-02 , -8.4656084656084651e-02 , -8.4656084656084651e-02 , 1.6931216931216930e-01 };
    return vdm_data;
  }

  static Scalar *get_dmats0_data() {
    static Scalar dmats0_data[] = { 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 2.0000000000000044e+00 , 3.6557177038629451e-15 , 1.1102230246251565e-15 , -2.6159630017730267e-15 , 1.1057821325266559e-14 , 8.8817841970012523e-16 , 2.3638031300394481e-16 , 3.9577394859323066e-16 , 1.1719020815487767e-15 , 1.7763568394002505e-15 , -8.8817841970012504e-16 , 3.8356056079118489e-15 , 8.8149652186670982e-17 , 2.2213712351041689e-15 , 8.8817841970012523e-16 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , -2.2973686445279136e-15 , 6.0000000000000044e+00 , 2.7866597918091423e-15 , -5.5900693025141082e-15 , 2.6645352591003749e-15 , -1.5987211554602272e-15 , -1.8108585618669063e-15 , 3.4679306751375772e-15 , -4.4408920985006262e-15 , -7.9195909089927907e-16 , -8.9084411144154247e-15 , 3.5881791365315908e-15 , 4.9501298122262600e-15 , -3.9968028886505643e-15 , -9.2518585385438258e-18 , 1.3333333333333353e+00 , 2.5646151868841102e-15 , 3.3333333333333353e+00 , -1.2836953722228787e-16 , 1.0924594562311539e-14 , 5.3290705182007514e-15 , -9.6643605949988418e-16 , 2.1238155267366496e-15 , 1.9984014443252830e-15 , 3.5527136788005009e-15 , 7.7715611723761293e-16 , 3.0494593008620461e-15 , -2.0915625198870059e-15 , 3.9357406222961834e-15 , 4.4408920985006262e-15 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 1.0000000000000027e+00 , -2.8458056017519709e-15 , -8.0000000000000226e-01 , 1.0000000000000011e+01 , -5.9285909514983358e-15 , 2.0000000000000140e-01 , -3.1263986676364484e-15 , -2.1648247568459774e-15 , 1.5728159515523050e-15 , -1.3877787807814457e-15 , 4.6325469180872455e-15 , -6.4302659717670912e-15 , -1.6761283718993686e-15 , -4.1577852272212116e-15 , 9.7144514654701197e-16 , -1.1958688008105270e-15 , 2.3999999999999995e+00 , 2.0428103653102863e-15 , 1.0518206676005392e-16 , 8.4000000000000092e+00 , -1.9539925233402820e-15 , -1.0912051985906573e-15 , 8.5587401363638649e-16 , -5.7731597280508132e-15 , -1.3914795241968654e-15 , -3.3320568526562455e-15 , 2.3302067346394111e-15 , 5.0804268199773993e-15 , 7.1054273576009995e-15 , 8.5117098554595032e-16 , 9.9999999999999933e-01 , -2.6818053950389908e-15 , 3.2000000000000011e+00 , 1.6132928326584272e-15 , 5.0626169922907108e-15 , 4.2000000000000064e+00 , 7.9379077198364132e-17 , -7.6687627441699958e-16 , -5.6744732369730061e-16 , 1.7763568394002505e-15 , 2.2204460492503422e-16 , -3.8884907265678864e-16 , 2.6482160086226593e-15 , 4.3169171940841527e-15 , 4.4408920985006262e-15 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , -1.1993159947499594e-15 , 4.0000000000000080e+00 , 1.9731948501437414e-15 , -1.3616059600470348e-14 , -1.7142857142857204e+00 , 1.8556584840163336e-15 , 1.4000000000000000e+01 , 6.0008180362576398e-15 , 2.8571428571428859e-01 , 1.7182023000151255e-16 , -1.1705220126501103e-14 , 5.5027998618689442e-15 , 2.3312113556423142e-15 , -6.3282712403633923e-15 , 2.2019423321732274e-15 , 8.0000000000000016e-01 , 2.2613808029473772e-15 , 7.9999999999999805e-01 , 2.8571428571428559e+00 , -1.1660513824348788e-14 , -1.4857142857142907e+00 , 1.2625959948335495e-15 , 1.2857142857142856e+01 , 5.2867763077388408e-15 , 5.1428571428571357e-01 , 1.6407914122035352e-15 , -5.7922802356971474e-15 , 2.0855231122298943e-15 , -9.4702024000525866e-15 , -3.5527136788005009e-15 , 2.8770312986532463e-16 , 1.1999999999999997e+00 , -3.2536331905341545e-16 , 3.6681848979326109e-16 , 5.4857142857142929e+00 , 2.3663610753438943e-15 , -2.1762699266538644e-15 , -1.1026720604879932e-15 , 1.0285714285714285e+01 , 3.6055814418778568e-16 , -2.6803212427317696e-15 , 3.7810663690927386e-15 , 3.3711459549815824e-15 , 2.6645352591003706e-15 , -4.6259292692720115e-17 , 7.9999999999999993e-01 , -2.5018787746989436e-15 , 2.7999999999999989e+00 , -1.0205130391532134e-15 , -1.0658141036401560e-15 , 4.7999999999999998e+00 , 7.6001681566216674e-16 , -1.0438446109835456e-15 , -1.5049689889363211e-15 , 4.7999999999999989e+00 , -1.5543122344752203e-15 , -8.0043528857044116e-16 , 3.1480733657744974e-15 , 3.4546439782919423e-15 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 };
    return dmats0_data;
  }

  static Scalar *get_dmats1_data() {
    static Scalar dmats1_data[] = { 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 0.0000000000000000e+00 , 1.0000000000000022e+00 , 1.8278588519314726e-15 , 5.5511151231257827e-16 , -1.3079815008865133e-15 , 5.5289106626332793e-15 , 4.4408920985006262e-16 , 1.1819015650197240e-16 , 1.9788697429661533e-16 , 5.8595104077438836e-16 , 8.8817841970012523e-16 , -4.4408920985006252e-16 , 1.9178028039559245e-15 , 4.4074826093335491e-17 , 1.1106856175520845e-15 , 4.4408920985006262e-16 , 3.0000000000000062e+00 , 4.7896871654036953e-15 , 1.7763568394002505e-15 , -8.1532003370910249e-16 , 2.0139445666700340e-14 , 8.8817841970012523e-16 , -9.7769716004427069e-16 , -4.0553979927279485e-16 , 1.7578531223231652e-15 , 3.1086244689504383e-15 , -5.3290705182007498e-15 , 7.0856760414179612e-15 , 1.9085813176802564e-15 , 1.5557000132560029e-15 , 1.7763568394002505e-15 , 6.6666666666666652e-01 , 3.0000000000000022e+00 , -3.3333333333333148e-01 , -6.8039806042394557e-15 , 4.3076653355456071e-15 , -1.4432899320127035e-15 , -2.0909101003170809e-15 , 2.2572093371374975e-15 , -1.4186183092432555e-15 , -3.8857805861880479e-16 , -8.0069342360082141e-15 , 3.5562929331644062e-15 , 6.7667065366621073e-16 , -5.7083967182810131e-16 , -4.7184478546569153e-16 , 6.6666666666666574e-01 , 5.0000000000000044e+00 , 1.6666666666666705e+00 , -6.5729475617481616e-15 , 6.3504757008558941e-15 , 8.8817841970012523e-16 , -2.1402965679223844e-15 , 5.2101027538914835e-15 , -2.1094237467877966e-15 , 1.3322676295501878e-15 , -9.3480875046964547e-15 , 2.4424626182403899e-15 , 2.1911484972115885e-15 , -1.5848433676524096e-15 , 1.7763568394002505e-15 , -1.3333333333333393e+00 , -2.9593611511952799e-15 , 6.6666666666666696e+00 , 9.0830121202145572e-15 , 1.5099033134902099e-15 , 5.3290705182007514e-15 , -6.4024356336582217e-15 , 3.4560831562868382e-15 , 7.6482030585288724e-16 , 2.6645352591003757e-15 , 4.4408920985006348e-15 , -1.5722926140996065e-15 , -5.6916919736975390e-15 , -1.2397490441647350e-16 , 4.4408920985006262e-15 , 5.0000000000000022e-01 , 2.4000000000000008e+00 , -4.0000000000000008e-01 , 5.0000000000000018e+00 , -6.0000000000000264e-01 , 1.0000000000000012e-01 , -2.0155032478377089e-15 , 1.2581481271274203e-15 , -2.4054832200211723e-16 , -8.8817841970012523e-16 , -2.5324521286591490e-15 , -2.0975505283300006e-15 , 2.6232873897827011e-16 , -4.4936276921703213e-15 , 7.9103390504542404e-16 , 4.9999999999999994e-01 , 1.1999999999999986e+00 , 8.0000000000000038e-01 , 7.0000000000000053e+00 , 4.2000000000000037e+00 , -7.0000000000000129e-01 , -3.5464957756907912e-15 , 2.2628889502958841e-15 , -1.5913196686293905e-15 , 1.1102230246251565e-16 , 1.7543901002729765e-15 , -2.6076082931533623e-15 , -9.7472184644608484e-16 , 9.5201624361607126e-16 , 4.4408920985006262e-16 , 5.0000000000000089e-01 , -3.6000000000000041e+00 , 1.5999999999999990e+00 , 6.9459869954534377e-15 , 8.4000000000000092e+00 , 2.1000000000000036e+00 , 1.7585436240380722e-15 , -3.2175394036347219e-15 , -3.6143927357241193e-15 , 8.8817841970012523e-16 , 8.2409195208595569e-15 , -5.6421851852044778e-16 , 1.6764496169875018e-15 , 9.7079751644931392e-15 , 1.7763568394002505e-15 , 2.5000000000000000e+00 , -6.5040565525957082e-15 , -2.0000000000000044e+00 , -8.1358531023312243e-16 , -6.6613381477510024e-16 , 1.0500000000000000e+01 , 4.3476726147410629e-15 , -6.2758440419783147e-15 , -4.4038846643464516e-15 , -3.5527136788005009e-15 , -6.2172489379008806e-15 , -2.2272447634793761e-15 , 1.2405393070815913e-14 , 6.5364380574806060e-15 , 0.0000000000000000e+00 , 4.0000000000000069e-01 , 2.0000000000000013e+00 , -4.0000000000000036e-01 , 4.2857142857142838e+00 , -8.5714285714286054e-01 , 1.7142857142857371e-01 , 6.9999999999999973e+00 , -7.1428571428571275e-01 , 1.4285714285714413e-01 , -2.8571428571428963e-02 , -2.5587556764763695e-15 , 5.0518885745106424e-16 , 1.0572818340990500e-15 , -4.2021941482062177e-15 , 1.7104373473131318e-15 , 4.0000000000000024e-01 , 1.2000000000000033e+00 , 3.9999999999999991e-01 , 1.4285714285714251e+00 , 2.9142857142857079e+00 , -7.4285714285714377e-01 , 9.0000000000000000e+00 , 6.4285714285714306e+00 , -1.2857142857142825e+00 , 2.5714285714285645e-01 , -2.3378418542616059e-15 , -2.2144463591677452e-15 , 3.0376935534882633e-16 , -2.4175106361212798e-15 , -1.1102230246251565e-16 , 3.9999999999999875e-01 , 6.0000000000000131e-01 , 1.0000000000000009e+00 , -5.7142857142857171e+00 , 2.7428571428571455e+00 , 5.7142857142857029e-01 , 4.1831759383463679e-16 , 1.0285714285714285e+01 , 5.1428571428571441e+00 , -1.0285714285714298e+00 , -2.6233420014476944e-15 , 1.5349394034142162e-15 , 9.0244170161371144e-15 , 2.4980018054063222e-17 , -2.8865798640254070e-15 , 3.9999999999999963e-01 , 4.2000000000000037e+00 , 1.3999999999999999e+00 , -6.6637846585579350e-15 , -4.8000000000000034e+00 , 2.4000000000000026e+00 , -3.8379072413561006e-15 , 1.7581413250593886e-15 , 1.2000000000000002e+01 , 2.3999999999999995e+00 , -9.1470523285360443e-15 , 6.0650792282209858e-15 , 3.4612230776971238e-15 , -7.9316183250928935e-15 , 8.8817841970012523e-16 , -1.5999999999999992e+00 , 2.7158169892854456e-15 , 5.6000000000000032e+00 , -2.3919358557325874e-15 , -7.0166095156309944e-15 , -2.4000000000000128e+00 , 4.2233332431700856e-16 , 4.3570746657883422e-15 , -8.1416355139178054e-16 , 1.4400000000000000e+01 , 4.4408920985005704e-16 , 5.6272607224914710e-15 , -6.8224746839638941e-15 , -5.3124171728313829e-15 , -5.7731597280508140e-15 };
    return dmats1_data;
  }


  public:

  /** \brief Constructor.
  */
  Basis_F0_TRI_C4_FEM_FIAT() : numDof_(15), isSet_(false) , vdm_( rcp( new Teuchos::SerialDenseMatrix<int,Scalar>(Teuchos::View,Basis_F0_TRI_C4_FEM_FIAT::get_vdm_data(),15,15,15) ) ),dmats0_( rcp( new Teuchos::SerialDenseMatrix<int,Scalar>(Teuchos::View,Basis_F0_TRI_C4_FEM_FIAT::get_dmats0_data(),15,15,15) ) ),dmats1_( rcp( new Teuchos::SerialDenseMatrix<int,Scalar>(Teuchos::View,Basis_F0_TRI_C4_FEM_FIAT::get_dmats1_data(),15,15,15) ) ) { }
  
  /** \brief Initializes arrays needed for the lookup of the local enumeration (DoF Id) of a 
    degree-of-freedom by its local DoF tag and the reverse lookup of the DoF tag by DoF Id.
   */
  void initialize();
  
  
  /** \brief Returns FieldContainer with multi-indexed quantity with the values of an operator 
  applied to a set of FEM basis functions, evaluated at a set of
  points in a <strong>reference</strong> cell. The rank of the return
  FieldContainer argument depends on the number of points, number of
  basis, functions, their rank, and the rank of the operator applied to them; see 
  FieldContainer::resize(int,int,EField,EOperator,int) for summary of
  the admissible index combinations.
  In particular, the admissible range of the <var>operatorType</var> argument depends on the rank of 
  the basis functions and the space dimension.Because FEM
  reconstruction relies on COMPLETE or INCOMPLETE polynomials, i.e.,
  smooth local spaces, the admissible range of <var>operatorType</var>
  always includes VALUE, D0, D1,...,D10. If derivative order exceeds
  polynomial degree, output container is filled with 0. 
 
      \param outputValues   [out]         - FieldContainer with the computed values (see
                                            implementation for index ordering)
      \param inputPoints     [in]         - evaluation points on the reference cell  
      \param operatorType    [in]         - the operator being applied to the basis function
  */    

  void getValues(FieldContainer<Scalar>&                  outputValues,
                 const Teuchos::Array< Point<Scalar> >& inputPoints,
                 const EOperator                        operatorType) const;
  
  
  /** \brief This method is intended for FVD reconstructions and should not be used here. Its 
    invocation will throw an exception. 
  */  
  void getValues(FieldContainer<Scalar>&                  outputValues,
                 const Teuchos::Array< Point<Scalar> >& inputPoints,
                 const Cell<Scalar>&                    cell) const;

  
  int getNumLocalDof() const;
  
  
  int getLocalDofEnumeration(const LocalDofTag dofTag);

  
  LocalDofTag getLocalDofTag(int id);

  
  const Teuchos::Array<LocalDofTag> & getAllLocalDofTags();

  
  ECell getCellType() const;

  
  EBasis getBasisType() const;

  
  ECoordinates getCoordinateSystem() const;

  
  int getDegree() const;

};

} // namespace Intrepid

#include "Intrepid_F0_TRI_C4_FEM_FIATDef.hpp"

#endif

